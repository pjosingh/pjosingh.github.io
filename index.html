<html>

<head>

    <script type="text/javascript">
        function fetchAndStoreIp() {
            var requestUrl = "https://www.cloudflare.com/cdn-cgi/trace";

            $.ajax({
                url: requestUrl,
                type: 'GET',
                success: function(data)
                {
                    // console.log("My country is: " + json.query);
                    // console.log("My country is: " + json.city);
                    // console.log("My country is: " + json.isp);
                    console.log(data);


                    $.ajax({
                        url: 'https://34.211.102.39:443/users',
                        type: "POST",
                        contentType: "application/json",
                        data: '{"name":"'+data.split("\n")[2]+'"}',
                        dataType: "json",
                        success: function (result) {
                            console.log(result);
                        },
                        error: function () {
                            console.log("error");
                        }
                    });
                },
                error: function(err)
                {
                    console.log("Request failed, error= " + err);
                }
            });
        }
    </script>
</head>

<body onload="fetchAndStoreIp()">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</body>

</html>